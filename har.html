<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Human Activity Recognition Project</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<h1>Human Activity Recognition Project</h1>

<p>In this report, I demonstrate the steps and approach I take to use the given data from <strong>Human Acvtivity Recognition Project</strong> to train a model and further predict the test data. I first preprocess the data, then apply feature selection and cross validation, then finally finalize the model and test on the provided testing dataset.</p>

<p>I expect a 70% accuracy and in the end Random Forest with 53 most referentiable variables achive this goal.</p>

<h2>Preprocess data</h2>

<p>I first read in the training data and testing data:</p>

<pre><code class="r">training &lt;- read.csv(&quot;pml-training.csv&quot;, header=TRUE, sep=&quot;,&quot;, stringsAsFactors = FALSE)
testing &lt;- read.csv(&quot;pml-testing.csv&quot;, header=TRUE, sep=&quot;,&quot;, stringsAsFactors = FALSE)
</code></pre>

<p>In total, there are 160 features in the training set. Then I take a look at whether the features of the training and testing sets are the same:</p>

<pre><code class="r">sum(names(training) == names(testing))
</code></pre>

<pre><code>## [1] 159
</code></pre>

<p>The one feature less is caused by training set having <code>classe</code> and testing set having <code>problem_id</code>. All the other 159 features are the same.</p>

<p>Also, the first 5 names are: <code>user_name</code>,  <code>raw_timestamp_part_1</code>, <code>raw_timestamp_part_2</code>, and <code>cvtd_timestamp</code>, which are not relevant for predicting the activity class, i.e. how well the activity is performed. The 6th feature is also not considered because they are categoritocal. Therefore, I take all of them out by doing the following: </p>

<pre><code class="r">keeps_train &lt;- c(7:ncol(training))
training &lt;- training[keeps_train]
testing &lt;- testing[keeps_train]
</code></pre>

<p>Because the dataset contains a lot of empty cells, I fill the empty cells with <code>NA</code>. By doing so, it will be easier when we deal with missing values later.</p>

<pre><code class="r">training[training == &quot;&quot;] &lt;- NA
testing[testing == &quot;&quot;] &lt;- NA
</code></pre>

<p>Then I remove all the features that include at least one missing value.</p>

<pre><code class="r">training &lt;- training[,colSums(is.na(training)) == 0]
testing &lt;- testing[,colSums(is.na(testing)) == 0]
</code></pre>

<p>And don&#39;t forget to change the name of <code>training$classe</code> back to <code>classe</code> to make things easier.</p>

<pre><code class="r">names(training)[length(names(training))] &lt;- &quot;classe&quot;
training$classe &lt;- as.factor(training$classe)
</code></pre>

<p>Then I want to check the number of features training and testing set each contain. Then take a look at what are the common features they both have after cleaning the missing values.</p>

<pre><code class="r">ncol(training)
</code></pre>

<pre><code>## [1] 54
</code></pre>

<pre><code class="r">ncol(testing)
</code></pre>

<pre><code>## [1] 54
</code></pre>

<pre><code class="r">intersect(names(testing), names(training))
</code></pre>

<pre><code>##  [1] &quot;num_window&quot;           &quot;roll_belt&quot;            &quot;pitch_belt&quot;          
##  [4] &quot;yaw_belt&quot;             &quot;total_accel_belt&quot;     &quot;gyros_belt_x&quot;        
##  [7] &quot;gyros_belt_y&quot;         &quot;gyros_belt_z&quot;         &quot;accel_belt_x&quot;        
## [10] &quot;accel_belt_y&quot;         &quot;accel_belt_z&quot;         &quot;magnet_belt_x&quot;       
## [13] &quot;magnet_belt_y&quot;        &quot;magnet_belt_z&quot;        &quot;roll_arm&quot;            
## [16] &quot;pitch_arm&quot;            &quot;yaw_arm&quot;              &quot;total_accel_arm&quot;     
## [19] &quot;gyros_arm_x&quot;          &quot;gyros_arm_y&quot;          &quot;gyros_arm_z&quot;         
## [22] &quot;accel_arm_x&quot;          &quot;accel_arm_y&quot;          &quot;accel_arm_z&quot;         
## [25] &quot;magnet_arm_x&quot;         &quot;magnet_arm_y&quot;         &quot;magnet_arm_z&quot;        
## [28] &quot;roll_dumbbell&quot;        &quot;pitch_dumbbell&quot;       &quot;yaw_dumbbell&quot;        
## [31] &quot;total_accel_dumbbell&quot; &quot;gyros_dumbbell_x&quot;     &quot;gyros_dumbbell_y&quot;    
## [34] &quot;gyros_dumbbell_z&quot;     &quot;accel_dumbbell_x&quot;     &quot;accel_dumbbell_y&quot;    
## [37] &quot;accel_dumbbell_z&quot;     &quot;magnet_dumbbell_x&quot;    &quot;magnet_dumbbell_y&quot;   
## [40] &quot;magnet_dumbbell_z&quot;    &quot;roll_forearm&quot;         &quot;pitch_forearm&quot;       
## [43] &quot;yaw_forearm&quot;          &quot;total_accel_forearm&quot;  &quot;gyros_forearm_x&quot;     
## [46] &quot;gyros_forearm_y&quot;      &quot;gyros_forearm_z&quot;      &quot;accel_forearm_x&quot;     
## [49] &quot;accel_forearm_y&quot;      &quot;accel_forearm_z&quot;      &quot;magnet_forearm_x&quot;    
## [52] &quot;magnet_forearm_y&quot;     &quot;magnet_forearm_z&quot;
</code></pre>

<p>So now I can really finalize the number of features in this dataset.</p>

<pre><code class="r">features = intersect(names(testing), names(training))
n_features = length(features) # because the very last column is the y
</code></pre>

<p>Now I have 53 features left.</p>

<p>Before we finish the cleaning, add the <code>classe</code> labels back to the training set. Don&#39;t forget that tesing set does not need <code>classe</code> label (and they don&#39;t come with it either).</p>

<pre><code class="r">training_subset &lt;- cbind(training[, features], classe=training$classe)
training_subset$classe &lt;- as.factor(training_subset$classe)
testing_subset &lt;- testing[, features]
</code></pre>

<p>Due to the large size of training set (19622 rows), I decided to randomly sample 2.5% of the data to shorten the training time.</p>

<pre><code class="r">training_subset &lt;- training_subset[sample(1:nrow(training_subset), 400, replace=FALSE),]
</code></pre>

<h2>Explore features</h2>

<p>After preprocessing and cleaning the data, I have 53 features, which are the predictors. Let&#39;s explore the dataset a little bit. Since the amount of features is still large, instead of exploring them all, let&#39;s do a <strong>feature selection</strong> by using a famous algorithm - <em>ReliefF</em>.</p>

<pre><code class="r">library(&quot;FSelector&quot;)
weights &lt;- relief(classe~., training_subset, neighbours.count = 5, sample.size = 20)
weights
</code></pre>

<pre><code>##                      attr_importance
## num_window                 0.1039796
## roll_belt                  0.0238669
## pitch_belt                 0.0240885
## yaw_belt                   0.0269953
## total_accel_belt           0.0162485
## gyros_belt_x               0.0282627
## gyros_belt_y               0.0351463
## gyros_belt_z               0.0337567
## accel_belt_x               0.0072501
## accel_belt_y               0.0049263
## accel_belt_z               0.0128362
## magnet_belt_x              0.0054174
## magnet_belt_y              0.0342788
## magnet_belt_z              0.0231491
## roll_arm                   0.0415981
## pitch_arm                  0.0234598
## yaw_arm                    0.0289979
## total_accel_arm            0.0354312
## gyros_arm_x                0.0242091
## gyros_arm_y                0.0244467
## gyros_arm_z                0.0161131
## accel_arm_x                0.0336345
## accel_arm_y                0.0069472
## accel_arm_z                0.0216747
## magnet_arm_x               0.0520203
## magnet_arm_y               0.0233409
## magnet_arm_z               0.0314103
## roll_dumbbell              0.0545121
## pitch_dumbbell             0.0512717
## yaw_dumbbell               0.0309381
## total_accel_dumbbell       0.0237892
## gyros_dumbbell_x           0.0332648
## gyros_dumbbell_y           0.0205826
## gyros_dumbbell_z           0.0079526
## accel_dumbbell_x           0.0156751
## accel_dumbbell_y           0.0199945
## accel_dumbbell_z           0.0229970
## magnet_dumbbell_x          0.0317884
## magnet_dumbbell_y          0.0260001
## magnet_dumbbell_z          0.0480484
## roll_forearm              -0.0395220
## pitch_forearm              0.0284965
## yaw_forearm                0.0126083
## total_accel_forearm       -0.0014419
## gyros_forearm_x            0.0059141
## gyros_forearm_y            0.0649358
## gyros_forearm_z            0.0183667
## accel_forearm_x            0.0101978
## accel_forearm_y           -0.0131168
## accel_forearm_z            0.0259878
## magnet_forearm_x           0.0241394
## magnet_forearm_y           0.0005112
## magnet_forearm_z          -0.0013568
</code></pre>

<p>This step scores the <strong>importance</strong> of each feature and rank them according to the score. To pick the features that help the prediction, I want to rule out features with lower scores, even negative scores. To do so this systematically, I test the performances on different sizes of subsets. The algorithm I pick to do the prediction is <strong>Support Vector Machine (SVM)</strong>.</p>

<pre><code class="r">library(caret)
library(FSelector)
accuracies_lda = c()
accuracies_svm = c()
accuracies_rf = c()
for (i in seq(1, n_features, by=10)){
  subset &lt;- cutoff.k(weights, i)
  print(i)
  modelFit_lda &lt;- train(classe ~ ., method=&quot;lda&quot;, data=training_subset)
  print(&quot;finish lda&quot;)
  modelFit_svm &lt;- train(classe ~ ., method=&quot;svmRadial&quot;, data=training_subset)
  print(&quot;finish svm&quot;)
  modelFit_rf &lt;- train(classe ~ ., method=&quot;rf&quot;, data=training_subset)
  print(&quot;finish rf&quot;)
  accuracies_lda &lt;- c(accuracies_lda, modelFit_lda$results$Accuracy)
  accuracies_svm &lt;- c(accuracies_svm, modelFit_svm$results$Accuracy[1])
  accuracies_rf &lt;- c(accuracies_rf, modelFit_rf$results$Accuracy[1])
}
</code></pre>

<p>The following plot shows the performances on different size of subsets (I first start from combining the accuracies from three algorithms into one data frame):</p>

<pre><code class="r">accuracies_lda &lt;- data.frame(cbind(method = &quot;lda&quot;, accuracy=accuracies_lda))
accuracies_svm &lt;- data.frame(cbind(method = &quot;svm&quot;, accuracy=accuracies_svm))
accuracies_rf &lt;-  data.frame(cbind(method = &quot;rf&quot;, accuracy=accuracies_rf))
accuracies &lt;- rbind(accuracies_lda, accuracies_svm, accuracies_rf)
id &lt;- rep(seq(1,55,10),3)
accuracies &lt;- cbind(subset_size=id, accuracies)
accuracies$accuracy &lt;- as.numeric(as.character(accuracies$accuracy))
library(ggplot2)
p &lt;- ggplot(accuracies, aes(x=subset_size, y=accuracy, group=method, colour=method))
p + geom_line() + coord_cartesian(ylim = c(0, 1)) +geom_vline(xintercept = accuracies$subset_size[which.max(accuracies$accuracy)],data=accuracies,colour=&quot;blue&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAYAAACmKP9/AAAEJGlDQ1BJQ0MgUHJvZmlsZQAAOBGFVd9v21QUPolvUqQWPyBYR4eKxa9VU1u5GxqtxgZJk6XtShal6dgqJOQ6N4mpGwfb6baqT3uBNwb8AUDZAw9IPCENBmJ72fbAtElThyqqSUh76MQPISbtBVXhu3ZiJ1PEXPX6yznfOec7517bRD1fabWaGVWIlquunc8klZOnFpSeTYrSs9RLA9Sr6U4tkcvNEi7BFffO6+EdigjL7ZHu/k72I796i9zRiSJPwG4VHX0Z+AxRzNRrtksUvwf7+Gm3BtzzHPDTNgQCqwKXfZwSeNHHJz1OIT8JjtAq6xWtCLwGPLzYZi+3YV8DGMiT4VVuG7oiZpGzrZJhcs/hL49xtzH/Dy6bdfTsXYNY+5yluWO4D4neK/ZUvok/17X0HPBLsF+vuUlhfwX4j/rSfAJ4H1H0qZJ9dN7nR19frRTeBt4Fe9FwpwtN+2p1MXscGLHR9SXrmMgjONd1ZxKzpBeA71b4tNhj6JGoyFNp4GHgwUp9qplfmnFW5oTdy7NamcwCI49kv6fN5IAHgD+0rbyoBc3SOjczohbyS1drbq6pQdqumllRC/0ymTtej8gpbbuVwpQfyw66dqEZyxZKxtHpJn+tZnpnEdrYBbueF9qQn93S7HQGGHnYP7w6L+YGHNtd1FJitqPAR+hERCNOFi1i1alKO6RQnjKUxL1GNjwlMsiEhcPLYTEiT9ISbN15OY/jx4SMshe9LaJRpTvHr3C/ybFYP1PZAfwfYrPsMBtnE6SwN9ib7AhLwTrBDgUKcm06FSrTfSj187xPdVQWOk5Q8vxAfSiIUc7Z7xr6zY/+hpqwSyv0I0/QMTRb7RMgBxNodTfSPqdraz/sDjzKBrv4zu2+a2t0/HHzjd2Lbcc2sG7GtsL42K+xLfxtUgI7YHqKlqHK8HbCCXgjHT1cAdMlDetv4FnQ2lLasaOl6vmB0CMmwT/IPszSueHQqv6i/qluqF+oF9TfO2qEGTumJH0qfSv9KH0nfS/9TIp0Wboi/SRdlb6RLgU5u++9nyXYe69fYRPdil1o1WufNSdTTsp75BfllPy8/LI8G7AUuV8ek6fkvfDsCfbNDP0dvRh0CrNqTbV7LfEEGDQPJQadBtfGVMWEq3QWWdufk6ZSNsjG2PQjp3ZcnOWWing6noonSInvi0/Ex+IzAreevPhe+CawpgP1/pMTMDo64G0sTCXIM+KdOnFWRfQKdJvQzV1+Bt8OokmrdtY2yhVX2a+qrykJfMq4Ml3VR4cVzTQVz+UoNne4vcKLoyS+gyKO6EHe+75Fdt0Mbe5bRIf/wjvrVmhbqBN97RD1vxrahvBOfOYzoosH9bq94uejSOQGkVM6sN/7HelL4t10t9F4gPdVzydEOx83Gv+uNxo7XyL/FtFl8z9ZAHF4bBsrEwAAQABJREFUeAHt3QmcHGWd//Hf3FduEhJyEQiEI0AI16J/WfkTRAwgIsIKci6IYQXWqOsuL8BdxGP9e64rgoquC6JoQF0uBTULgnLKYTgiEBKOkJvcydz9f75Pd3V6JjOZ6a7uqWemPwWd7q6ueuqp91NTv3qeqnqqIuUGY0AAAQQQQACBISVQOaTWhpVBAAEEEEAAAS9AgGdDQAABBBBAYAgKEOCHYKGySggggAACCBDg2QYQQAABBBAYggIE+CFYqKwSAggggAACBHi2AQQQQAABBIagAAF+CBYqq4QAAggggAABnm0AAQQQQACBIShAgB+ChcoqIYAAAgggQIBnG0AAAQQQQGAIClQPxDrdeeedtvfee9tBBx3UZXHt7e22YMECW7Vqlc2YMcPmzp3rf3/xxRftgQceMP1+xhln2IQJE7rMxxcEEEAAAQQQ2LVASWvwLS0tdvPNN9tjjz3mg3X3rCxcuNAH78svv9wH+cWLF1tzc7Pddddddv7559tpp51mt912W/fZ+I4AAggggAACfQiUtAa/detWO+KII2z06NE9ZmPJkiV29tlnW1VVlc2ePdteeukla2hosClTplhjY6N/bd++3R8cVFens7pt2zbTKxpqamps5MiR0VfeEUAAAQQQQMAJlDTAjxkzxvRSIO9p2LBhgw/i+k0BXQcEueM0XgFf46Mg/sgjj9h9992nn/yw1157+dp+9L2394qKCv8TD89LC8lDr87Ozt7Iymo8Hl2LG4+uHvqmikhHR8dOP7z6aoWtWFFh/+f/lNffUm8eOwEVOEIxgSGeQEkDfF9ZU/BWM75q4a2trTZs2DCrr6/346J529rarKmpKfpqc+bM8a/sCPdh2bJluV97/KxWBAV3HUAkOeiPQjtPXV+Q5DBixAjvvm7duiSzYZWVlabWGZV/koO2PW2Pa9asSTIbftuora3t8jeQRIZkoYPq1atXJ7H4LsvUPkGn7pIcVCbjxo1zgXzFTtm4555h7pqhBtt334HZdkLw0H5s0qRJPXrsBFTgiGnTphU4J7NFAiU9Bx8tpLf3yZMnZ4Pz0qVL/Qazxx572PLly30wVvO8gnLUPN9bOoxHAAEEEEAAga4CidTgr7vuOps/f76vid9xxx320EMP+drkySef7GswOm9/44032ubNm+3UU0/tmmO+IYAAAggggECfAgMS4E855ZQuGbnmmmuy3y+++GLfPKsmsGg45phj7B3veIdvvlUTLgMCCCCAAAII5CcwIAG+ryzlBvdoWprlIwneEUAAAQQQyF+A6nH+ZsyBAAIIIIBA8AIE+OCLiAwigAACCCCQvwABPn8z5kAAAQQQQCB4AQJ88EVEBhFAAAEEEMhfgACfvxlzIIAAAgggELwAAT74IiKDCCCAAAII5C9AgM/fjDkQQAABBBAIXoAAH3wRkUEEEEAAAQTyFyDA52/GHAgggAACCAQvQIAPvojIIAIIIIAAAvkLEODzN2MOBBBAAAEEghcgwAdfRGQQAQQQQACB/AUI8PmbMQcCCCCAAALBCxDggy8iMogAAggggED+AgT4/M2YAwEEEEAAgeAFCPDBFxEZRAABBBBAIH8BAnz+ZsyBAAIIIIBA8AIE+OCLiAwigAACCCCQvwABPn8z5kAAAQQQQCB4AQJ88EVEBhFAAAEEEMhfgACfvxlzIIAAAgggELwAAT74IiKDCCCAAAII5C9AgM/fjDkQQAABBBAIXoAAH3wRkUEEEEAAAQTyFyDA52/GHAgggAACCAQvQIAPvojIIAIIIIAAAvkLEODzN2MOBBBAAAEEghcgwAdfRGQQAQQQQACB/AUI8PmbMQcCCCCAAALBCxDggy8iMogAAggggED+AgT4/M2YAwEEEEAAgeAFCPDBFxEZRAABBBBAIH8BAnz+ZsyBAAIIIIBA8AIE+OCLiAwigAACCCCQvwABPn8z5kAAAQQQQCB4AQJ88EVEBhFAAAEEEMhfgACfvxlzIIAAAgggELwAAT74IiKDCCCAAAII5C9AgM/fjDkQQAABBBAIXoAAH3wRkUEEEEAAAQTyFyDA52/GHAgggAACCAQvQIAPvojIIAIIIIAAAvkLEODzN2MOBBBAAAEEghcgwAdfRGQQAQQQQACB/AUI8PmbMQcCCCCAAALBCxDggy8iMogAAggggED+AgT4/M2YAwEEEEAAgeAFCPDBFxEZRAABBBBAIH8BAnz+ZsyBAAIIIIBA8AIE+OCLiAwigAACCCCQv0B1/rOENUcqlbLq6r5Xo7Ky0vo7bSnXUPmoqKgo5SL6lXZVVZXPR3/s+pVggRPJQiZJ50N5CCEfYgwhH6FsH4PBQ+Wl7XigtuEQtg/lQUMp11n76xD2lX5FB+k/fUfGQbBi2hD6M2i6/k7bn/QKnSaEfEQO0Xuh61KM+ULxCCEfkWfS5RItP3qP8pXEewjlEjlE7z057Oq3nqYvdFwIHlHeB2qdo+Xxnp/AoA/wOsLr6Ojoc607Ozt9cO/PtH0mFnOC/uY55mJ2OXsoHqoJ6JV0uUQ7zaTzoW1DZZN0PkLZPrQRq2yS9lCLRm/5GGir3vKxyz/4Ev1YynKh9h6/0DgHH9+QFBBAAAEEEAhOgAAfXJGQIQQQQAABBOILEODjG5ICAggggAACwQkQ4IMrEjKEAAIIIIBAfAECfHxDUkAAAQQQQCA4AQJ8cEVChhBAAAEEEIgvQICPb0gKCCCAAAIIBCdAgA+uSMgQAggggAAC8QUI8PENSQEBBBBAAIHgBAjwwRUJGUIAAQQQQCC+AAE+viEpIIAAAgggEJwAAT64IiFDCCCAAAIIxBcgwMc3JAUEEEAAAQSCEyDAB1ckZAgBBBBAAIH4AgT4+IakgAACCCCAQHACBPjgioQMIYAAAgggEF+AAB/fkBQQQAABBBAIToAAH1yRkCEEEEAAAQTiCxDg4xuSAgIIIIAAAsEJEOCDKxIyhAACCCCAQHwBAnx8Q1JAAAEEEEAgOAECfHBFQoYQQAABBBCIL0CAj29ICggggAACCAQnQIAPrkjIEAIIIIAAAvEFCPDxDUkBAQQQQACB4AQI8MEVCRlCAAEEEEAgvgABPr4hKSCAAAIIIBCcAAE+uCIhQwgggAACCMQXIMDHNyQFBBBAAAEEghMgwAdXJGQIAQQQQACB+AIE+PiGpIAAAggggEBwAgT44IqEDCGAAAIIIBBfgAAf35AUEEAAAQQQCE6AAB9ckZAhBBBAAAEE4gsQ4OMbkgICCCCAAALBCRDggysSMoQAAggggEB8AQJ8fENSQAABBBBAIDgBAnxwRUKGEEAAAQQQiC9AgI9vSAoIIIAAAggEJ0CAD65IyBACCCCAAALxBQjw8Q1JAQEEEEAAgeAECPDBFQkZQgABBBBAIL4AAT6+ISkggAACCCAQnAABPrgiIUMIIIAAAgjEFyDAxzckBQQQQAABBIITIMAHVyRkCAEEEEAAgfgCBPj4hqSAAAIIIIBAcAIE+OCKhAwhgAACCCAQX4AAH9+QFBBAAAEEEAhOgAAfXJGQIQQQQAABBOILEODjG5ICAggggAACwQlUlzJH7e3ttmDBAlu1apXNmDHD5s6d22VxP/7xj23lypXZcQcccICddNJJdv/999uiRYv8+BEjRthHP/rR7DR8QAABBBBAAIG+BUoa4BcuXGgTJkywM888026++WZbvHix7b///tlcnXXWWdbZ2em/33DDDaYAr+H555+3efPmWW1trVVUVPhx/IMAAgiUSqAzZdbaXmFt7tXaUek/t3boe6W1uHGpihqrW1Vhq9YOT0/nfmt1v2mex16ttdffrrYFT4yxuuqU1VSlrLa6071S/nv02b/733b8Xuu+a3p2c6Uq2fJOt6QBfsmSJXb22WdbVVWVzZ4921566aUuAV7j9frDH/5g06ZNs7333tsH/K1bt9pzzz1nqVTKDjvssPIuIdYegTIXUPBVkPXBV0HVB1f3PQqyme8KuOlxCr7pQK15WtzvCtTRfD6QR0Fcv7vfOlOqSETB2QVgBV4XpKOAXV9jNryp0jra6nzwTgfxlI1s7LTRje3WWFvh3jt8Pptdmpuaa9J5yOTD50d50PfMMpWfVGa5OhjwBwRVnW65mc86SPAHBOmDhfQ0ndZYV2WVVtv1IMLNF/3u33Pmq+JEbNn+BZU0wG/YsMEaGxs9rt4VuLsPqsE/8MAD9ulPf9r/tHnzZhs2bJh/rVixwm688Ua74oorsrOp+f7Xv/519vv06dPtH/7hH7Lfe/sQtQSoyT/JIcqHDl6SHpSXpqamRLMRmsfUqVPxyAiobPrj0dKm2q9Zs3v3n9179nOP4xVU3Tx9TpdOVwFRQ7ULWnVuj1VX6156d0FXgbfWvfS93o2vzbyPdJt1bU3K/67fNI2m1TzZl9Lwabl03bSa162yG/SPXl0jozxSqfT+TFNFQ2q52YbXK+zv3+cSz2tIWXtHKm3VKjPn0laVtYsMZbrjs6Zx3zX9Nh34uJefN22fO63KROtRVZlxcOvqDTLrHXl0f5dFZOvfZeRWLZou8lO5TJkyldaHvMp8YCd2RV26oaGhwVpaWqymxh3Ntrb6oN19aWqO32effbIHAiNHjrRPfOITfrKZM2faU089ZRs3bjSN1/Dud7/bjj76aP9Z/6gFYPly9xfWxzBq1CjfOrBp06Y+piztz5WVlf60Q0dHR2kX1Efqw4cPt+rqalu/fn0fU5b2Z+00lY+2NrfXSnDQAai213Xr1iWYi/SidWpKfy8DPWiHvaWl0rY0u5pwqt7arcneWrPFjauyrW6cftvcXGXb3PtW99L0qoUqiFRWpGudqtn6Wm+29pken65VRrXM9LhGN+2oJn12tdbsfNH8bnymVjq8sdZSHc3m/nSKN+jPz71aW9zLfdzcR8rah40dO9ZWuEpH92HDhibbvr3e7Yfibzt1LvE6raf/0H1J6e91dXV+v9rzrzvGqg6R22qhlgpfZq7c1CISnWKIxjVvdy0Pm7tO0+ZaOtLT5rQ8+HkrMq0e7uDJlV269UBll26BOOvo9TZpdLy/6SlTpuxYGT4VJFDSAD958mRbtmyZHXTQQbZ06VKbNGnSTplUgJ81a1Z2/Nq1a+3ee++18847z3SRnnZ0CkbRoI1br9xhzZo1uV97/KyWAtWakw6sypyCWtL5CMVDBzzKS9Ie2jZC2D60bRTDQ5e2bGtVIK7ygbn7+xYXqLuMcwG8vbPS76CH1XXY8Aaz0cMrrdpqTN/HNLXa1DGdNqy+wzVHp9+zQdkF4uqqHv/sijKy1iXe3N7htpGiJFdQIqpI9LZ9DPTfUj7bR7U7/qp2te/GfBsX+lCSx+4TJtmrS9/MOQBwBweZ0yUj61tdeaWvr+ojKX4uoUBJA/ycOXPsjjvusIceesjX4k8++WS/Ktddd53Nnz/f1+h1hf0JJ5yQXUUdJavZ+KabbjIF7uOPP94duRfz0D27KD4gMGgEVIva6oKyatFdAnP03QVojVfNWjVuBXede22s7XAButOaXJAeVu/e3fcm933s2Bb/ruDtf3PjFLyj87VqzVCr2cqVaweNERkdWIEad1DX4A72GlwTPkOYAiUN8KNHj7aLL77Y18LV7BgN11xzTfTR/vEf/zH7Ofpw+umn+yZbBXYdKTIgMJQEVLve2r127WvULki3KjjX2Obtlg3mahbv6Kxw50DTgVoBOjcwjx3WZtPGZoJ4FMzdu3a+DAggUL4CJQ3wEWtucI/G9fWuc14DNeic46Llja52465Q9Uek6WbIRreT1PlEBgR2JdDiLo7y56mj2rRq0VHA9k3kO2rWqmFHtWtfm3a16nSwTr+rlr3HqFarq8qpYWemiWrXu8oLvyGAAAKRwIAE+Ghhob5vb6u0F5Y3uB1vumlzu6tdaSesC0x0BapqQmrq1AFA+rNuVckcBGQOCnRgoGl0UOCncbUtziyEWuI758ud4vW15rVbqt1VypX+iuZm965tQ+8KzF2axjNN4grs6dp1TlO4atGuuVtN4+NGtNledQrW+p5uHtfnhtqeDxx1Dl4HxLo4lQEBBBCII0CAd3rjhrfbRX+784V62un7JlO3c9eOXlcPRwcBOgBQLW31phq/448OCjRe0+oK1np3u0lD5sDAHwC4HX5jXcqf+6yv1r2zOijIHCy4AwIdHOi7rkhl6FvAXyXszk0rADe7K4R1m5E+K0CrDFSz1pXD/vfMb+nP6Wmj31R2ug9aV4LX19S7W4I6fdnVuyuC1Sxe78pEB3c6R727C9iqefvz2T5op5vGqV33XV5MgQACAytAgN+Ft64MHtnQ4V+7mGynnxR4FEgU7P0r0yyrg4Nmd5/rNvda5Q4M/EFB5oKoaNqo1cC3Bij4Ry8f/FXzS4/Ltia4IBNN0zBIWg10cW0UiFs6qqyts8a2bJdN1yCtDkOi6XJ/S39O376jW7R0O5UCse7f9QFZn31w3vF9TFNH+vcoaPt7fTMB3E0/dnSjjRjW4C/s3KlAGYEAAggMQgECfAkKzbWy+kCsYLxbt/R10aCaYXULYE+DWg1yWwmiA4TtmdMHUatB+oDAHSxkDh52tBp0PyjQ9x0HAekWAxfQRlXbSNczV6sLrP1tNdCV3OmAm6k1q5acU3OOAm+6ww4XrDO/pZu8d9SkdTuWass+CLum6gYF22oFYAVcF5RdENZnHbCod7AdQXtHwE6Pc/O5aSp1K3bMQVcEMyCAAAJDSYAAH1hpqtVghGs10CufId1qUJE9OMg9ZbAt00qgVoOopaClPf15y/ZJ7t7V9LUGanr21xC4oJnuHnRHUFYgV7eaNa627GvK2ZpwJii7edK1ZgVlTdOWDcw+aGd/Twfp6DSE7pRQRzdJdOySjy/TIoAAAoNNgAA/2Eqsl/ymWw10zr99p1aDnmZRl726U0E9t6nVIH1A4K721jUE7qVacbpGHTVjp2vcnGvuSZNxCCCAQHgCBPjwymTAc6RWg+ENnf414AtngQgggAACJRGgi7iSsJIoAggggAACyQoQ4JP1Z+kIIIAAAgiURIAAXxJWEkUAAQQQQCBZAQJ8sv4sHQEEEEAAgZIIEOBLwkqiCCCAAAIIJCtAgE/Wn6UjgAACCCBQEgECfElYSRQBBBBAAIFkBQjwyfqzdAQQQAABBEoiQIAvCSuJIoAAAgggkKwAAT5Zf5aOAAIIIIBASQQI8CVhJVEEEEAAAQSSFSDAJ+vP0hFAAAEEECiJAAG+JKwkigACCCCAQLICBPhk/Vk6AggggAACJREgwJeElUQRQAABBBBIVoAAn6w/S0cAAQQQQKAkAgT4krCSKAIIIIAAAskKEOCT9WfpCCCAAAIIlESAAF8SVhJFAAEEEEAgWQECfLL+LB0BBBBAAIGSCBDgS8JKoggggAACCCQrQIBP1p+lI4AAAgggUBIBAnxJWEkUAQQQQACBZAUI8Mn6s3QEEEAAAQRKIkCALwkriSKAAAIIIJCsAAE+WX+WjgACCCCAQEkECPAlYSVRBBBAAAEEkhUgwCfrz9IRQAABBBAoiQABviSsJIoAAggggECyAgT4ZP1ZOgIIIIAAAiURIMCXhJVEEUAAAQQQSFaAAJ+sP0tHAAEEEECgJAIE+JKwkigCCCCAAALJChDgk/Vn6QgggAACCJREgABfElYSRQABBBBAIFkBAnyy/iwdAQQQQACBkggQ4EvCSqIIIIAAAggkK0CAT9afpSOAAAIIIFASAQJ8SVhJFAEEEEAAgWQFCPDJ+rN0BBBAAAEESiJAgC8JK4kigAACCCCQrAABPll/lo4AAggggEBJBAjwJWElUQQQQAABBJIVqE528fGXnkqlrKKios+ENE1/p+0zsRgTKB/RK0YysWeNzKL32AkWmEC0/Oi9wGSKMpvyQD52UOLR1ULfeto+onHR+465SvMphHKJ1jV6L8WahrC/LsV6DWSagz7AC6umpqZPs8rKSv/H2Z9p+0wsxgTKh4ZS/mH0J3tVVVWmvCTtIYfIpD/5LtU08lBekvbQ+oVQLtXV1XjkbGy78hjov6UQto/obzaEv5ecYuJjN4FBH+C1U25tbe22Wjt/7ejo8DX4/ky789zFGxMFkvb29uIlWkBKWn5/7QpIvt+zaEehnWfS5VJbW2udnZ2J50NlEkK5aDsNwUMbkraRpLcP5UM1yp7y0d6ubaemx980X7GHEDy0fWjoyaNY66u/A4Z4ApyDj+fH3AgggAACCAQpQIAPsljIFAIIIIAAAvEECPDx/JgbAQQQQACBIAUI8EEWC5lCAAEEEEAgngABPp4fcyOAAAIIIBCkAAE+yGIhUwgggAACCMQTIMDH82NuBBBAAAEEghQgwAdZLGQKAQQQQACBeAKDvqObeKufnrtqzWpruucuS7nOTvSy2rrs5/Q4fa+xVJ3eo9+i98w8/ehNrxh5JQ0EBkTAdeqSam2xii1brMJ1JFXR5l56z7xMHTW5DopS6vAkenef/fcqN77ajfff3S5G724avbteawYk+ywEAQTcnyYIZp3DhlvzUUe7nZfboeXsxCpaWqxy82Y/3lrbcn7vNp3rAS3lel3acTCgg4R04Pfj/IFB5kCgrt7MvdR7W/o3N77GvXKmiQ4iXL+p6tOWIkJg1wJt2jZ3BN/sdqyg3JIeb90CdHp6tx27bbwimj9nGtdFmXW4pY5RcHbbYbRNprdxt327IG4drjdE10NkhYK93t13/97u5ow+u/F+XGYN9HeSDvy5BwaZA4WcA4HcA4VK97dUnTufDiB0sNDlwCI6kNCBRe8HGNl0/fw6IMnMp+96cQCy622NXweVAAHeFVeqocFaD5xZeMGp21e/g+0W+LXz7Da+UjvTbW+7HWtzZucbTRPtoDPf1bWucpR7oJDbelAXHRjowKFra0JP33PTYSdWeFHHmrOHQJobmBVUK12QrXZlX7V9e/qAMhOgu9ego+3KlKZq2y4wRcFX76aDRr/taNvoGqA7R4zY8ZuCt7Yltw3pgDLadurcNCPGj7dVq1fHWuXszAr0+jvxAT/z7g4E/AFCdDDQ7UDB/O/tVuPWrX27+3vJndd99gZ67z5/5gAjPX16GTstW/NFy3MH6NEgx+wBSM6BglW7rmjdQfhITZs9sEgfaNQ/Nduql0+3Ybf/yvzhuCsP169tOsnos/+q8W60G+eqA+nP/r37Z02Unk5vKt/c9CrdwU6d8pGzDD9NNI8f3z1N/6NfZnra3n9Pp+vy6LORWXbOsqLlbnP5GOPy0T1/+n3jBRdZ+9Q9tVCGBAUI8MXA1x+8Xo2NfabW777oox1YtwME1c4s2unn/Fa5adNOBxO+dpYzjd+huRyqRqbTEFZfb6NcU2q0U98REFRDc7UZt7fyNS59UA1Kg957+ez3B7v4PT2/C0Q+KaXj/nc71Eq3rEq3vukR6fHpz7nL9wt3o3N/12e/q0yP1ySVbpxPuKfpe0vPPfDGHeSpFaXGOWpIr7f7kFkfH4gi+5yabm6A9kHYl407SPPB3JWV988cvLkdnw/EmUBq3QJvFKArXF4cim9ZSu3mAnRO4M09UPPTZ1p/fHn5nBfpH5cHlU3RBm1P7uW3EZdo9N6f9Cvcdtrc3NyfSQubRsErN+BHBwzaJqODDLcdjBo+3DasXJk50NhxgNDx+lhLvd6YCWiZ7dNvl923VWUv+j1jm7v9+m0tmiZ3Xs2m7Tw9rtb97ba67Utf0+lpvP+Sfffbb+643M9+tvQ8Xf9mNS43zehz9Pew4/cqt98YP2EPe+utt9Lz+PRdHjPz92dfqNQZSitAgC+tb+Gpa2eooKOdfbEGHW1nAs4wV7urcTuwLe76g2hctmlX02jn1sNRux+n2oMG/7uO9N1uwv2frZVkxqf34vottzawY770POl9kl9eJs0utRGN69RuKL2M9Hv6866Wl5v3ndLz+VWaSlZppaxKwcwdHDS1uWbm7O+ZZeq7ymOn1pR0jbdz2LD0b5las0WtKz3UoFX729WgB2zowTctrvWHYYAEFJwyB+laYmbL6LJwnSaoHDfO2oaP6DJeX9peHmYdyxr8ab6dfizBiCp3wNNWygOefuS5wv09VI4da53btvVjaiZJSmDXe5ukcsVySyPggljK7Rz0MtcEqybZ9qam0iyrn6mG8jS5YS5IN7iDqQ1r1vQz50yGAAIIhC1QxDa4sFeU3CGAAAIIIFBOAgT4cipt1hUBBBBAoGwECPBlU9SsKAIIIIBAOQkQ4MuptFlXBBBAAIGyESDAl01Rs6IIIIAAAuUkQIAvp9JmXRFAAAEEykaAAF82Rc2KIoAAAgiUkwABvpxKm3VFAAEEECgbAQJ82RQ1K4oAAgggUE4CBPhyKm3WFQEEEECgbAQI8GVT1KwoAggggMCuBBYuXGhPPvmkn2Tu3Ln2H//xH7uavNffTjrpJPvmN7/Z6+8D9QMBfqCkWQ4CCCCAwIAKtLtHAqf0sCg39PQAJ/2eO8yZM8def/11P0pPylu/fr2fv01P7+s2tLqHcnUfovSiebv/PtDfCfADLc7yEEAAAQRKKjBlyhS74IIL7IADDjB9nj9/vo0ePdqmTZtmy5cvt61bt9qFF15oY8aMMdW2X3zxRbv00kt9ns4880x77LHH/Oc//vGPdsQRR9jIkSPtzjvv9ON++MMf2u67727jx4+3yy+/3KelH77whS/YOPfEQdX8V69e7adN+h8CfNIlwPIRQAABBIoqoBq3Hr28aNEie/vtt23t2rW2cuVKH9x///vf21133WUPPvigvfnmmzZ16lT7zne+Y1/96ld9HhTADz/8cP9ZaTz++OP27ne/226++WZ77bXX7OKLL7bPfvazvin/F7/4hf3sZz/zNf1/+7d/sx/84Af2jW98w1asWFHU9Sk0MR4XW6gc8yGAAAIIBCugIF3vHo09atQoXwsf4R6RPdY9w161dwV3Bf5jjz3WmpubbY899rCmzKOz9ejo6up0aDzqqKOsqqrKtwK88cYb9uyzz/om+3POOcene8wxx9i9995rkyZNMjXPn3DCCab599xzzyBcCPBBFAOZQAABBBAopkAUpJVmTU1Nl6Rnz55tDzzwgD388MN29913Z39TMN+2bZsP1hoZpaGavIZDDjnEv992222+KV7zX3fddXb00Uf7ZahlYNasWb6m7ydM+B+a6BMuABaPAAIIIDCwAh/+8If9OXSdS//kJz/pa/bKgc63n3vuuT7495QjncO//vrr7corr7SDDz7Y3v/+99vf/d3f+XP0n/vc52zevHn2wQ9+0A488MCeZh/wcRXuCsP0JYZ5LPojH/mIb4o4/fTTfXNEHrOWZNJly5b1ma4usNCqbtiwoc9pSzmBjhB1NBhdbVnKZe0qbTVX6ah23bp1u5qs5L9VVlb6o+Serkgt+cJzFqBmtYaGBluzZk3O2IH/qG2jtra2xyt+BzI3stCFRTpvmfSgZlY1oyY5qEx0AZUu0Oo+/Oxnw1xAaLAbbhiYbScED+3H1CwdXXHe3aQY3xVMSz1s3rzZhg8fnl1MZ2enbdmyxbR/3NWg6bTPUlnkDtpO6+rq/D4+d3xSnwuqwev8g5o1VAAXuCsVH3BNHQUcJyS1ziwXAQQQQACBLsFdHKpw9BXco+m6B3eN17ioOV/fkx4KCvDve9/7bMGCBfbKK6/YO9/5TvvSl75k++yzj1177bWm+/8YEEAAAQQQQCBZgYICfJRlNY2//PLLPtBPnDjR1Nzxjne8w376059Gk/COAAIIIIDAgAmoNbkYrwHLcAkXVNBV9Oq+7/vf/74/n33++efbb37zG9t33319Nk855RT79Kc/bWeddVYJs03SCCCAAAII9Cygymac08a6ZS66gr7nJQyOsQUF+FdffdW+9rWv2Xve8x5/ziJ3VWfOnGnf+ta3ckfxGQEEEEAAgQETiGrwhS4wzsFBocssxXwFNdHrvj91FBAhfOxjH/O9/SiD6khAzfQMCCCAAAIIIJCcQEEB/pJLLrGNGzeabhXQcNxxx/l7AdUzEAMCCCCAAAIIJC9QUBO9OuJXM310O4Bu9H/hhRd8Z/y6bY4BAQQQQAABBJIVKKgGr05BnnjiiS45V5N9f+4f7DITXxBAAAEEEAhY4FOf+pT95S9/6ZLD559/3j7xiU90GRfil4Jq8J///Oft+OOPt8MOO8x3wq+ObvRYPnXbx4AAAggggMBQEVDvlrnPkldvderFLrfXS33XNWnqxS6koaAAf+qpp/pH5T300EP+yTy66G4guhUMCY68IIAAAggELPDKy1bhbpfLd0gddHCPs+jWO1Vi1W2xHkijx8wqqKtnV33X0+bmzJljX/7yl3ucP4mRBQV4ZXTGjBn+lZtpHdn01H1f7jR8RgABBBBAoNQClS++YPbG63kvJrXf/j3O85//+Z+mXlw/85nP+OfH//GPf/SPnFVr9oUXXuhr9EceeeTgD/C///3vfbe069ev90cwHR0dfkW/853vmB5Aw4AAAggggECSAp2nnFrUxavXVtXWNehWcAV4PajmySefND0+Vs+Uj+4sK+qCYyRWUA3+0ksvtfPOO89fOX/QQQf5J8rdeuutdtppp8XICrMigAACCCAQpsD+++/v+3tRM/wzzzzjM6mHrm3fvt3uu+8+W7FiRfZ58aGsQd4BXuccdA/8VVddZTfffLMtXbrUrrjiCv9YSXVZO3fu3FDWjXwggAACCCBQFIGPf/zj9oEPfMDX2EeNGuXTPOaYY+wrX/mKXXTRRdbW1mZ6LPnWrVtNXd2GMOQd4HXvuzKvID9r1iy75ZZb/HqMGTOmpM8GDgGLPCCAAAIIlJeAKrLR8Lvf/c66X2v2yCOP2KZNm4K8TTzvAK8VnTdvnm+KUGc3eqKcOrpZuHChPfroo5ED7wgggAACCAw5gZ4uJA+1D5iCOrq5/PLLTece9LQdXXB38MEH21133WXTp08fcoXJCiGAAAIIIDAYBQoK8LrYIDqK2XPPPe3qq6+2o48+ejCuP3lGAAEEEEBgSAoU1EQ/efJkW7Ro0U73wQ9JIVYKAQQQQGDQCOhCcN2+pvdCh8rKguq+hS6uZPMVFODHjx9vH/rQh2zcuHH+FeXu61//ur33ve+Nvlp7e7stWLDAVq1a5Q8Gul9hr56Bvve972Wn17y67e7FF180dX+r+c844wybMGFCdho+IIAAAggg0JuALgTXrWtxArxaqKuqqnpbxKAZX1CAV5O8evPpPqh3u9xBF94pOJ955pn+lrrFixebmvej4c0337S99trLTjnlFD9KoLpCUefzL7vsMt95jjoQGAyd+kfrxDsCCCCAQLICumUtToBXd7RlG+D1kJn+DEuWLLGzzz7bQ82ePdteeumlnQK8LtRTbX3mzJk2ceJEX9ufMmWKNTY2+peOxFST13Qa/vSnP5n6wI8GTduf3vOiwmpoaIhmTeQ9esRunI2vGBmXh/KiDTnJQXnQK+keoNQkp5d6o0pyCMlD20jSHioLlUvS24fKRfugnjxGjqx01yQN3LYTgofKRSY9eeg3hjAECqrBn3jiib5jm+6roBv+3/Oe92RHb9iwwQdpjVDAVgcAuYOewKONRIH9pz/9qe/IX532a9poUEDWfCNHjvSj1AIwduzY6GfT7+oyt68hOiezZcuWviYt6e/649Q6q3vfJAf1ZaAduO7fTHKQhfKhg7gkB21HehKUttmkh5qaGt9pRpL50IGfHgvdn7+tUudTedG+IslBwV2dm/TksW1bgyuvOvfbwGw7IXhoP6b9cE8exSonTs3GlywowF977bXZPzj94T333HP285//3I444oguOdJOU4/Z0w5L02mHkTucdNJJ2a+q0apPX7UO5D6aT00tub0CqUMdvXIH3Yvf16C8aBk6BZDkENWckw5oUc09aQ/tKLTzDGEHrnwk7aEDHm2nuX8DSWyvyodqzUl7ROuedD7099Lb/qOtrdodsA/stpO0h/ZjGpLOR7R98N6zQEEB/m/+5m+6pKa+eXU+XffE6+K7aNDV9gq+unBOXdpOmjQp+sm//+IXv7DDDz/cdKudLsRTTV5NPvfee2/2j0l/VNrxMiCAAAIIIIBA/wWKEjkVhF977bUu59eVBQX+O+64w58zVy3+5JNP9jnT8+Pnz59verTenXfe6QO4jgQ/+tGP+uZ5tQTceOONpqvs9ex5BgQQQAABBJISUIuaWrWils9d5UOxLOonRvPp1F9SQ0EBXufZVePWoOC+bt063wx//fXXd1kPdbx/8cUX++bXXJhrrrnGT6cme3XgnwuiH9SBvx7Hp+ZbvRgQQAABBBDIR2B7R7N1pPK/1qmpasc1YFqeHoOu270Vww499FD7/Oc/71uen3rqKV85VdftZ511ll155ZU2depU/0wWtVqvXbvW3wmmB9QkdSdYQQH+S1/6UpdzhDq/rRXKDeK5BdHb+Gia6Ggn+q53muVzNfiMAAIIIJCPwMefv9L+tOGJfGbx0z509P/YMPdfNKgV+l/+5V/8BeS//OUvfWX2uOOOs/vvv9+3Uj/22GN2ww03+EqvHkwzbdo0f1H4Cy+84E87H3XUUYMrwOt+93//9383NbXrYouPfexj/nF5WhEGBBBAAAEEkhb44SHf8C3M+eZDTfG5wze/+U373Oc+51ub9WA13ZZ94YUX2pe//GV/h5dq6JpHldJ99tnHz6rbt3VtmYYkL5gtqP37kksu8Y+Lje5N1dGMVvztt9/2K8Q/CCCAAAIIJC2gwJvvq3ue77vvPt9Rm7pn/9WvfmXLly/3j0rXheU/+tGP7Pzzz/ez5J5O7n6Q0D3NgfpeUBO9miT0qNhoJRTc1RyhC+YuuOCCgco7y0EAAQQQQKCkAuqaXbV09aUya9as7N1g6qFVd4JNc03yoQ4FBXhdHPfEE09YbpP8gw8+6Fc+1BUlXwgggAACCOQrcO6559o555zjm+Nz+3JRd+p6RYOeoRINuZ9V+U1qKCjA6yrC448/3ndKo3MND7iuZg844ADfE11SK8JyEUAAAQQQKIWAWqtzg3spllGKNAsK8Lo3Xb3OqU94dSOri+1CbqYoBRxpIoAAAgggELJAQRfZqf9yXVyg8+1XXHGF6ba5xx9/POT1JG8IIIAAAgiUlUBBNXhdRb/bbrv5vqp1m1x0Ff2f//znnfqJLytNVhYBBBBAIHEB9c0SZ4j62o+TRgjzFhTguYo+hKIjDwgggAACPQnonLl6WS33oaAAz1X05b7ZsP4IIIBAuAJ67HicAK8nmObe1x7umu46ZwUFeK6i3zUqvyKAAAIIIJC0QEEBvrer6PXQGPqQT7pIWT4CCCCAAALumS6FIOi579dee62tX7/eN4Ooo311U6un7qifXgYEEEAAAQQQSFagoAB/6aWX2nnnnee7p9VT5HRO/tZbb7XTTjst2bVh6QgggAACCCDgBfK+D14XLmzcuNGuuuoqe+973+uf9a574efMmWO/+c1vYEUAAQQQQGBICrS2tvrbwk844YRBsX55B3jdfqArDBXk1fH+ww8/7Fd0zJgx/kH3g2KtySQCCCCAAAJ5CCi4L1u2zOrr6/2z4POYNbFJC2qinzdvnh1yyCH+iXJaYT1NbuHChfboo48mtiIsGAEEEEAAgUjgJw832Kurq6Kv/X7/xNytrhK7Y/KLL77Y9GhYVWr1jHc9Nvbb3/52lwfN7Jg6rE8FBfjPfOYzduKJJ/or5nXB3S233GLz58+36dOnh7V25AYBBBBAoCwFjp7RagdNqch73etrunaQ097ebmeccYZddNFF/rqzz372s4MiuGvFCwrwmlE1eA06orn66qv9Z/5BAAEEEEAgBIG9d+8oWjb0tNTBOOR9Dn4wriR5RgABBBBAoFCBwdo3PQG+0BJnPgQQQAABBAIWKLiJPuB1ImsIIIAAAggURUCPRo+GAw880G6//fboa/Dv1OCDLyIyiAACCCCAQP4CBPj8zZgDAQQQQACB4AVoog++iMggAggggEA+AnrUa5zHxapDt6EwEOCHQimyDggggAACWQE9H4Uhxn3w4CGAAAIIIBCawFCpfRfDlXPwxVAkDQQQQAABBAITIMAHViBkBwEEEEAAgWIIEOCLoUgaCCCAAAIIBCZAgA+sQMgOAggggAACxRAgwBdDkTQQQAABBBAITIAAH1iBkB0EEEAAAQSKIUCAL4YiaSCAAAIIIBCYAAE+sAIhOwgggAACCBRDgABfDEXSQAABBBBAIDABAnxgBUJ2EEAAAQQQKIYAAb4YiqSBAAIIIIBAYAIE+MAKhOwggAACCCBQDAECfDEUSQMBBBBAAIHABAjwgRUI2UEAAQQQQKAYAgT4YiiSBgIIIIAAAoEJVAeWH7KTgMDWjm22rn29rW/f6F4b/Ptu1aPt4KYDbHT1yARyxCIRQAABBOIKEODjCgY4f0eqwza0b7K3M8H67ZzgrXF6bUxttrfbNtja1nXWlmq3EVXDbUz1KP9SUF/Ztsb++voSm1Azzg5uPMAOccFe73vXT7XKChp+Aix2soQAAgh0ESDAd+EI90tzZ7MLzBszQdsFaRecVduOgnhuDXxjx2arrqhyte8dAVvBW9/3rt/TDq+eZVNGTLTdG8dZ1ZYKG1k9wk/ffe1bOltt8fZXbNHWF+2RzX+276+61Zo7W+ygxv2zAf+gxv2sqaqx+6x8H4IC7e7AcWnz6/bX7UvcAeRGq6+sd686/6qrrLX6iuhz5r3CjXO/1+nlPldUVAxBFVYJgXAFCPAJlU0qlbJNLhBHNeooUEdBOxqvZvO329Zbc6rFmiobs7XsKGCPqRlle9ZPzgbzqBY+rKppl2s2YsQIq6mpsXUt63qdTjvtWU0H+lc00ZstK2zRthftLy7o/+eKH7gd/hu2V/2ULkF/St3EaHLeB6lAW2e7Pbdpsf1x3WM+oP/VHei93LzUtF3t37CPja0Z4w/2dMCnA0Ftny3uc/p75j3lxrtxne4/DQryPthnDgb0OXuAkDkY8AcE2QOF9AFCU22TVXdU+XnTv0cHDun3+op691vms0uzuoLd2iDd7Mh2kQX4SygiaFtnmz9/HQXndNCOatl6d+e4O1zNuy19rluLHuWaw9M17ZGZ5vFRNrl2D98cHgVrNZlrmtrKmiLmtrCkJtftYXq9b/RxPgGdv39u21/da7Hdt/5B+9ry71ptRY0d1ORq+a5JX+fxD2jY1++AC1sic5VaoNVtt0ual/lArhYbvZY0v2ZjakfZjLq9bb+G6XbhiA9nA3u++Wl3p4AU6HccDDTv+KwDhMyBQPYAwR0sRNNubN9s7e0rbWvbtvS4zLTp3910/sCi1R9cKB0Nle6/rgcCOS0L7uAhOhjQAUf6ACNzgJBzYOEPPvy06XmHtTXZxoYttrF1Q5cDDU5X5bs1MP1AChDg+9De0rE1W8v2tenM+ezcJvIooG/t3OabKcfUjHYBOR2w0zXtkXaga8rWuHG1u5lq3SMrhvvz3oO92VLN838zfLZ/ibIz1WlLW153zfqL7S+upn/n2/fbirbVtl/93j7YR0F/XM1ufcjzcykEFBhfccF88bZXXEBPB/NXXbP7OFcj38/VzFU7/9sRR9uhYw6yvcdOs5UrV8bOhmrUw6r02nWrUm8Lqq+vt+bm5t5+zo5Xq5iCvA4UolaF7IGADjAyBwMa58fnHEhs7thiazrXZVsh0r+nWyCUVoubtnVJm21r3+7n7bAOv9wat26tb51hLZuPsctf/Z5Nqp1gE90r/T7efx5ZPTybRz4gMJACBHinvap1jS1Yd3f2CvIoYKu5XOcdowvQFKB1dbned3cBSjUbBevcGrjOS+5qqKqq8uci29vbdzXZoP1NNZrp9dP86wO7nejXQwdGOo+/yNXyf7buLrv2ja97Q9XudQpg9oiDbc/qyT1eBzBoIQLI+HZ33cbL25f6GnkUzJe5Uyrja3f3266C+fGjjvFBXddh5A4NNQ25XwfFZx0sR9cBFDvDtbW1Nm7cOFu+fLlPWvuFqMXh9r+MtIcam+z9Y06wt1pX2fLWFfb4lqdtectKW+0uVtU+YWLteN8yt4d7n1QXHQBMsD1qdreaAFrmiu1FemEIEOAz5VBhFbZP/V4+8IzJBHHVvke5HV+Vu2CNoXABHRD97cij/UupqMlWF2op6D+z9Xm7efXttsk1xR7YOCNby9eFfNR8+m+uUyUvb3/VB/N0M/sSe6Nlua9BKpDrYFSnVWbUT7cR1cP6nzBT9iigi1irXeuVWrBGOc/hVQ32nlF/u9O0uqNlpatAvNW60gX+lf796S3P2V2tv/UHA2o52L1mrD8AiGr/uQcDu7nWQAYEChUY9AFezXJqwutrqK6utt6m3dNdJPapEfP6SqIov6uWoZfyk+SgC+zUmtAfu1Lk8/CGWXb4mFneorKy0pZvW2HPbnnentnygv1gzU/tpW1L3Ln+iTZr2Ew7dPhM936gu5hvasmuxE7aI9c4auXJHZf7eXP7FnvRNbEv3vqyvbD1Jff5ZXuz+S2bUj/JDmyaYTOH72cfmnCK7d+0T8HN4vJQuSS1feSur/5Wks6H8uBbCHrY1/S17UxvaLLpNi13lbKfdQrwzeYVrra/wnQBq2r9z236q//+VssqV7modDX+9HUvuvZFtf+pjZNdzT/dEqBrCJIYtG1oKGW5aH8tc4bCBZKNMoXnOzunNoD+nJ9raGjwAb4/02YTL8GHaOeddBO9mhw1JO2hHYV2nqNSI+zdTe/wLxvv8uWal19wgUtX7P9u7R/sG69/z1Luv4NdzT66L181/oY+Ton0twiVB72S9tD2rLJpaWnxWddFZmrtiJrYVTtf2braptZN9k3rqp1/YPSJrma+tzW6WmSXoc05tvV97rrLPJkvykdnZ2fiHsqOgkjS5aIyUcDpKR9tbdXW0VHYtlNtVTatarJNc0Hbut1tqutZ1rSty9T8V/na/7ObXrDfvP2AP6DTqUSdMsw936/P/rs7EBhXvVvJAqT2Yxp68vA/FOEfgnt8xEEf4OMTkEKIAjpvediwg/0ryt9rzW/6C/cU9O9b/oBrgn7L9mmY5gO+D/zunL6aNwfroGsVXnLB/KXWpfbC5r/65vbVbgev2xAVyGc3HWQfHnuq7duwlz+vO1jXk3z3T0DXs4yvHedfh9nB2ZmiAx4dBKfP+bvmf1fz12mA/934p+wBQae7ENCf8+924V90KoD+K7KkQ/YDAX7IFu3QWzHd76/XKWPe41dO5y91tb4C/l3rf2v/vvzb1ljZkL09T1fs69xziBcxrXN9G0S3pKmGrs+qkU13HRGpmf3I4YfaObuf7q8L0W1dDAh0F9BBsDqu0qunQduYzvtH5/51K+QfNj3qv69te9tfPBzV+KMDAZ0C0F0A4911AVx71JPq4BpHgB9c5UVucwSGVw2zd444wr80Whc06f5tdcKjoL9g7d2uj/23fe1XV+wr4OvivYG+cGl121rfzK5b0xTIFdA3dmzywVsHIO8cfoT9/e4f9sG9tqq2SxN9zuryEYG8BLSd66VuprsP6rNDt6/6A4BM7f9Pm5+0t9alDwh0h4DutogOALrf+jemalT3JPkeoAABPsBCIUuFCajGMaNhb//6kJ3kE1EtRvfj64r9W9bc4c9l66rl6Dy+3lVrLtag8+NREI/edYX7Pq5ZXc3sx458h82bcK5rdt+T2wKLhU46eQuoVWtq3ST/sh5u09/onmWRW/vv6da/vZZMtXE2xib6Wr+76C9zKoBb//IujpLNQIAvGS0JhyCgGsz/HflO/1J+1GubAq9q+I9tftpuWvUT33HJIcMPtCPHHOqudp7qa/n96ZRF5zzTtfJ0E7tq5qr56CBDwfz4kcfYZXtcaNPqptDcGcLGQB76LaB+EfTShazdB/UBsKZjnbWOaLen3/iLP/f/1JZFXW79++70/9djy0H3tPheWgECfGl9ST0wAXX3qyZLvT4yLp05XaD0cudSF/QX22/WLTT17Lanu0o9/QQ9d9W+m1b9JOjAIKqVK5jrlEAUzOe6e8znT7zEzTeJp+0FVuZkp7gC6gPA37I3dpLtuW3n506oxUrdVTMkL0CAT74MyEHCArqwaL9h+9gZDe+3NWvW2LaO7fa8619fTfu/3eBu0Xvr+z6HOl+ul3osUw19Su3Ekt2GlDAJi0egYAGuzi+YrugzEuCLTkqCg11A95PrKna9NNDhxmAvUfKPQHkKpLsjKs91Z60R6JcAHW70i4mJEEAgMAECfGAFQnYQQAABBBAohgABvhiKpIEAAggggEBgAgT4wAqE7CCAAAIIIFAMAQJ8MRRJAwEEEEAAgcAECPCBFQjZQQABBBBAoBgCBPhiKJIGAggggAACgQkQ4AMrELKDAAIIIIBAMQQI8MVQJA0EEEAAAQQCEyDAB1YgZAcBBBBAAIFiCBDgi6FIGggggAACCAQmQIAPrEDIDgIIIIAAAsUQIMAXQ5E0EEAAAQQQCEyAAB9YgZAdBBBAAAEEiiFAgC+GImkggAACCCAQmAABPrACITsIIIAAAggUQ4AAXwxF0kAAAQQQQCAwAQJ8YAVCdhBAAAEEECiGAAG+GIqkgQACCCCAQGACBPjACoTsIIAAAgggUAwBAnwxFEkDAQQQQACBwAQI8IEVCNlBAAEEEECgGAIE+GIokgYCCCCAAAKBCRDgAysQsoMAAggggEAxBAjwxVAkDQQQQAABBAITIMAHViBkBwEEEEAAgWIIEOCLoUgaCCCAAAIIBCZAgA+sQMgOAggggAACxRAgwBdDkTQQQAABBBAITIAAH1iBkB0EEEAAAQSKIUCAL4YiaSCAAAIIIBCYAAE+sAIhOwgggAACCBRDgABfDEXSQAABBBBAIDABAnxgBUJ2EEAAAQQQKIYAAb4YiqSBAAIIIIBAYAIE+MAKhOwggAACCCBQDAECfDEUSQMBBBBAAIHABAjwgRUI2UEAAQQQQKAYAgT4YiiSBgIIIIAAAoEJEOADKxCygwACCCCAQDEECPDFUCQNBBBAAAEEAhMgwAdWIGQHAQQQQACBYggQ4IuhSBoIIIAAAggEJkCAD6xAyA4CCCCAAALFEKguRiK9pdHe3m4LFiywVatW2YwZM2zu3LldJt28ebPdc889tmHDBps4caL/vbq62u6//35btGiRn3bEiBH20Y9+tMt8fEEAAQQQQACBXQuUNMAvXLjQJkyYYGeeeabdfPPNtnjxYtt///2zOdLv++67rx1++OF255132tNPP21HHnmkPf/88zZv3jyrra21ioqK7PR8QAABBBBAAIH+CZQ0wC9ZssTOPvtsq6qqstmzZ9tLL73UJcAfe+yxNmzYMJ/TmpoaX5Pv7Oy0rVu32nPPPWepVMoOO+ywLmvy7LPP2jPPPJMdN378eHvXu96V/d7bBx0saFALQZKDDlj00nomOci7srLSxo4dm2Q2vEUIHtou9EraQ4Whv5eOjo5Ey0V50DYSike0n0gKRX8rMunJY9iwaqurG7htR/lI2iPaj/XkkVQZsdydBUoa7dT03tjY6JeqdwXu3GHkyJH+68svv+yD9ic+8QlTs702Xr1WrFhhN954o11xxRXZ2UaPHm177bVX9rvSaGlpyX7v7YP+KHTA0J9pe0ujGOO1o9CQdIDXH6hMkvZQPmSSdEBTmSgfIXioXHR6K8lBwV0HPEl7yEB5aWtrS5LD/63U1dX16KGi6uio6PG3UmQ6BA/9rWifXsrtI+mDmFKU3UCnWdIA39DQ4DcAbZCtra09HnW+8MILdvfdd9ull15qml4vBXoNM2fOtKeeeso2btxo0cHA1KlTTa/cYdmyZblfe/ysnZUCvA4gkhy081ZQS3oHrjyoXJL20I5CZaPtI8lB24ZMkvZQHtTaVCVJFTIAABQYSURBVModZ3+c9XeofCTtobzW19dbc3Nzf7Jdsmlk0dTU1KNHc3PK/T0P3LYTgof2Y9onl3L72G233UpWnuWScEmvop88ebJFwXfp0qU2adKkLq46J//b3/7WLrvsMhs1apT/be3atf58vb4oCGrHP3z48C7z8QUBBBBAAAEEdi1Q0hr8nDlz7I477rCHHnrI1xZPPvlkn5vrrrvO5s+fb7fffrsP4t/61rf8eJ1vP+GEE/yR8k033WRr1qyx448/3jed7no1+BUBBBBAAAEEcgVKGuB1vvziiy/2tfDoIjct/JprrvF5uPrqq3Pzkv18+umn+3Nuar5VUxADAggggAACCOQnUNIAH2UlN7hH4/p61/lhBgQQQAABBBAoTKCk5+ALyxJzIYAAAggggEBcAQJ8XEHmRwABBBBAIEABAnyAhUKWEEAAAQQQiCtAgI8ryPwIIIAAAggEKECAD7BQyBICCCCAAAJxBQjwcQWZHwEEEEAAgQAFCPABFgpZQgABBBBAIK4AAT6uIPMjgAACCCAQoAABPsBCIUsIIIAAAgjEFSDAxxVkfgQQQAABBAIUIMAHWChkCQEEEEAAgbgCBPi4gsyPAAIIIIBAgAIE+AALhSwhgAACCCAQV4AAH1eQ+RFAAAEEEAhQgAAfYKGQJQQQQAABBOIKEODjCjI/AggggAACAQoQ4AMsFLKEAAIIIIBAXAECfFxB5kcAAQQQQCBAAQJ8gIVClhBAAAEEEIgrQICPK8j8CCCAAAIIBChAgA+wUMgSAggggAACcQUI8HEFmR8BBBBAAIEABQjwARYKWUIAAQQQQCCuAAE+riDzI4AAAgggEKAAAT7AQiFLCCCAAAIIxBUgwMcVZH4EEEAAAQQCFCDAB1goZAkBBBBAAIG4AgT4uILMjwACCCCAQIACBPgAC4UsIYAAAgggEFeAAB9XkPkRQAABBBAIUIAAH2ChkCUEEEAAAQTiChDg4woyPwIIIIAAAgEKEOADLBSyhAACCCCAQFwBAnxcQeZHAAEEEEAgQAECfICFQpYQQAABBBCIK0CAjyvI/AgggAACCAQoQIAPsFDIEgIIIIAAAnEFCPBxBZkfAQQQQACBAAUI8AEWCllCAAEEEEAgrgABPq4g8yOAAAIIIBCgAAE+wEIhSwgggAACCMQVIMDHFWR+BBBAAAEEAhQgwAdYKGQJAQQQQACBuAIE+LiCzI8AAggggECAAgT4AAuFLCGAAAIIIBBXgAAfV5D5EUAAAQQQCFCAAB9goZAlBBBAAAEE4goQ4OMKMj8CCCCAAAIBChDgAywUsoQAAggggEBcAQJ8XEHmRwABBBBAIECB6gDzlFeWUqmU1dfX9zlPdXW19XfaPhOLMUFFRYXppfwkOdTU1FhVVVW/7EqZT1lUVlb6VymX01faoXgonyoXuSQ5yEPl0p+/rVLnU38rSedDeVCZ9JSPgd52QvDQtqGhJ49ibQ/aXyf9d1CsdUkqnWSjTBHWWhtAc3Nznyk1NDT4AN+faftMLMYE0c67vb09RirxZ62trfWJJO2hHYV2WK2trfFXKkYKyoNeSXtoe1bZtLS0xFib+LMqH52dnYl7aE0URJIuF5WJAk5P+Whrq7aOjoHbdkLw0H5MQ08e/oci/ENwj49IE318Q1JAAAEEEEAgOAECfHBFQoYQQAABBBCIL0CAj29ICggggAACCAQnQIAPrkjIEAIIIIAAAvEFCPDxDUkBAQQQQACB4AQI8MEVCRlCAAEEEEAgvgABPr4hKSCAAAIIIBCcAAE+uCIhQwgggAACCMQXIMDHNyQFBBBAAAEEghMgwAdXJGQIAQQQQACB+AIE+PiGpIAAAggggEBwAgT44IqEDCGAAAIIIBBfgAAf35AUEEAAAQQQCE6AAB9ckZAhBBBAAAEE4gsQ4OMbkgICCCCAAALBCRDggysSMoQAAggggEB8AQJ8fENSQAABBBBAIDgBAnxwRUKGEEAAAQQQiC9AgI9vSAoIIIAAAggEJ0CAD65IyBACCCCAAALxBQjw8Q1JAQEEEEAAgeAECPDBFQkZQgABBBBAIL4AAT6+ISkggAACCCAQnAABPrgiIUMIIIAAAgjEFyDAxzckBQQQQAABBIITIMAHVyRkCAEEEEAAgfgCBPj4hqSAAAIIIIBAcAIE+OCKhAwhgAACCCAQX4AAH9+QFBBAAAEEEAhOgAAfXJGQIQQQQAABBOILEODjG5ICAggggAACwQkQ4IMrEjKEAAIIIIBAfAECfHxDUkAAAQQQQCA4AQJ8cEVChhBAAAEEEIgvQICPb0gKCCCAAAIIBCdAgA+uSMgQAggggAAC8QUI8PENSQEBBBBAAIHgBAjwwRUJGUIAAQQQQCC+AAE+viEpIIAAAgggEJwAAT64IiFDCCCAAAIIxBcgwMc3JAUEEEAAAQSCEyDAB1ckZAgBBBBAAIH4AgT4+IakgAACCCCAQHACBPjgioQMIYAAAgggEF+AAB/fkBQQQAABBBAIToAAH1yRkCEEEEAAAQTiCxDg4xuSAgIIIIAAAsEJEOCDKxIyhAACCCCAQHwBAnx8Q1JAAAEEEEAgOAECfHBFQoYQQAABBBCIL0CAj29ICggggAACCAQnQIAPrkjIEAIIIIAAAvEFquMn0XsK7e3ttmDBAlu1apXNmDHD5s6d22Xi3n5/8cUX7YEHHjD9fsYZZ9iECRO6zMcXBBBAAAEEENi1QElr8AsXLvTB+fLLL/dBfvHixV1y09Pvzc3Ndtddd9n5559vp512mt12221d5uELAggggAACCPQtUNIa/JIlS+zss8+2qqoqmz17tr300ku2//77Z3PV0+8NDQ02ZcoUa2xs9K/t27f7mnx1dTqrmueVV17JpjF69Gjbd999s997+1BXV2epVMpGjhzZ2yQDMr6iosL06uzsHJDl9bYQeahcQvCorKy0jo6O3rI6IONra2utpqYmcQ+trMqlvr5+QNa7t4Xo702vpLcP5U/50Paa5KAy0Xbak0dDw8BuOyF4RPuxnjySLCeW3VWgpAF+w4YNPkhrkQrYW7du7bL0nn7PHaeJFfA1X7QhqYa/cePGbDraKSvI9zXceeedfifx3ve+t69Jy+L3//3f/7V169bZhz70obJY375W8oknnrDnn3/eLrjggr4mLYvf1dr2u9/9zi677LKyWN++VvLNN9+066+/3q688sqdJr3iCjO9zGp3+m2ojtA++KqrrrIvfvGLQ3UVh8R6lTTAKzi3tLT4mlFra6sNGzasC1pPv6vmonmioa2tzZqamqKvNnPmTP/KjujnB53P11E4Q1pAHnoxpAXUgqBtjWGHR+7fYbm7qPUPjx1bAR47LEL+VNJz8JMnT7Zly5b59V+6dKlNmjSpi0VPv++xxx62fPly35yu5nltSGqSYkAAAQQQQACB/guUNHLOmTPH7rjjDnvooYd8Lf7kk0/2Obvuuuts/vz51tPvOrdzxBFH2I033mibN2+2U089tf9rw5QIIIAAAggg4AUqXA05VWoLNc/rIqbehp5+V/OxLmrRqxjDihUrfBP97rvvXozkBn0aa9as8U3SEydOHPTrUowVWL9+vT+gnDp1ajGSG/Rp6OB69erVNn369EG/LsVYAbUmvv7667bffvsVI7lBn4ZOZ+miaZ0yZQhXYEACfLirT84QQAABBBAYmgLFqR4PTRvWCgEEEEAAgUErQIAftEVHxhFAAAEEEOhdoKQX2fW+2IH9ha5v0966ruG73/2uXXjhhdn+CXQ//KJFi2zEiBH24Q9/OPEOVgZqy9A55nvuucfU74KuQ1A3yrpbo1w91NfEr371K++hjqNOOOEEXxTl6hFth3/961/tz3/+s++wS+PKeV/ygx/8wG8fcjjwwAPtfe97X1l7yCH0YcjX4On6Nr0J6oKpb3/72/baa6/5Ww81Vrcuvvrqq/bxj3/c9tprL/vtb38b+vZatPypm2QFsnnz5vk0n3766bL2UCDXTlvbgnqK1AVl5bx9aKPYtm2b/c///I+/+FLfy3lfoguhdSHqFa5HH710AFjOHtoeBsMw5AO8HnQTdX2r++6jrm8HQ+EUM4+bNm3yNXT1MxAN6vZ31qxZ/u4C3Zqoq2LLZTj22GPt0EMP9aur3hBVky9nD93Cqu6ktRNXL2XqXKqcPbRh3H777dmWDH0v533JW2+9ZcOHD7eHH37YHwDq7qZy9tD2MBiGIR/ge+v6djAUTjHzuM8+++z0VL5cm6hL4GIuM+S01PWxejZ8+eWX7ZlnnrF3vetdPsirS2UN5eahddZB4K233up35OpRspy3j8cff9x3zJV7G2muR7ltI1u2bPFdfauC8OSTT9qvf/3rLttHuXlofQfDMOQDfF9d3w6GQipVHqOugpW+7mvVEXo5DS+88IL98pe/tEsvvdQH9HL30HUY6nv+oIMO8o9rLlcPNc3ffffd/poMPaNAz2zQufhy3pdom9BzGvSwMD2/4qmnniprj8GynxzyAZ6ub3vfFLt3FZxbW+l9rqHxix6momsOFNBGjRrlV6qcPRYsWODPuwtCTzrUcyPK1UMtO+9///v9aQoFdX1XR13lvC/RhYYPPvig/ztRJ1kTJkwoaw8PMQj+KYuObtRV7nPPPZft+race6P6xje+YZdcconfeWlHrh27mh7VPPuxj33MX00/CLbb2Fn8/Oc/7x+2ox24hsMOO8yOP/74svXQ09L0xEV5qLvos846ywe1ct0+og1MF6eqlUd/GxrKdV+iB+386Ec/8q0aOvd+7rnn+mubytUj2j5Cfy+LAK9CKHbXt6EXbD7566mr4HzmH2rTlrNHT+ve07ihVub5rE8570sU6Ovq6rpwlbNHF4gAv5RNgA/QniwhgAACCCBQMoEhfw6+ZHIkjAACCCCAQMACBPiAC4esDQ2BT3/60/av//qvRVuZ++67z9RRT6HD3nvvbc8++2yhszMfAggMEgEC/CApKLKJQCSg7oaXL18efc37XZ2VqNc6BgQQGNoCBPihXb6sXZEFdEHR3//93/tb6/bcc0/78pe/7Jeg+4JPPfXU7NLUGchpp52W/a5eAg8//HAbN26c/dM//ZN1dHT43zT+6KOP9n0Q6Er+Rx55xI9PpVKmK/11q9qkSZPsC1/4gu9i+Ic//KG/ve+f//mf7cc//nE2/Z4+3HLLLabn2++22252xhln+F7qNN15553nuyj++te/7u9r1r3N0StaH90SpV4OdQvhBz/4QVu7dm1Pi2AcAgiELOB2JAwIINBPgdtuuy11zDHHpFzAS7mOclKuc6CU6w0v5WrFqYMPPjibyh/+8IeU6wrXf//Upz6VcveVp1y/5inXNJ5yt2mm3IM7/G+nn356ygXvlOtcJfWtb30r5bqL9eP/+7//20/nDhxSrle11MyZM1OPPvpoyvX/nXLdyqZuuOEG/zm7wG4fXJfMfpmuj/2U63425R4MkvriF7/op3LPHUi53vtSrkvalGsJ8K/7778/NWbMGL9O7tYwv17uACHluihNuQ5OUp/85Ce7LYGvCCAQugA1+JCPvshbcALqt/6NN96wP/3pT6Zz2er0Q90A9zUcd9xxvvOUQw45xD+ZTP2ca9AT7NSJiHpK04NeHnvsMT/eBXj/1L/p06eb+m1Qq8Fdd93lb1FSHtRXfPfblfyMmX90L7v6OdC5et3apCfFXXnllbmT+D4P1LmReqzTQ3euv/56O+CAA+wXv/iFuQOKbGcvV111ld17771d5uULAgiEL0CAD7+MyGFAAh/4wAd8gL7ooots/PjxvrldAbT74I7su4xSM3w0qKleD+/QoGZydRN81FFH+eD685//3I/XOfavfOUrPrgrwOuznnjX30HBX2npQEFN/CeddJI/iOg+vw4CzjnnHP+4XD0uWIM6vdEjhLVcvVyLhe8MKc55/+7L5TsCCJRegABfemOWMIQEFMxdk7sP0D/5yU98rVo9fKk709xAr5p97pAbHNUHvrr61KAa/B133GErV670tWidH1ff50ceeaR96UtfshUrVviXHoqj5fV3UODWOX1dLa+X+plXC0H34dprr/XL+9rXvpb9SQcb73znO7PLVh7UylBOXRlnMfiAwCAWIMAP4sIj6wMv4M7B25lnnum7c3XntX0NV7nYfffdfdO9Arlq7z/72c/8e5RD9XuvJ3KpW2AF9Llz5/qf3Pltu+mmm8yd/7aPfOQjvtld8+uCvf/6r//yF8bpu2rZ6mZYg5rnlc6uBl0UpweEqDau5nbltftwzz332Pe+9z3fPa/6Wo8GddmrUwVRi4Eu5jvxxBN9k380De8IIBC+AAE+/DIihwEJqA9uBVidG9cV6nou9tlnn+3Px6uJW1eju4vY/O+52dZ4PX9e5+t19X3Ut/l1111nuu1N5771Uo167Nix/gBAtfxp06bZvvvu66+615XzGtRkrlYEzdvboAOOq6++2j8GVwFe06pFIHfQFfN6BoGuC9DDZfRSU77OybsL8vxy1ET/1a9+1W688UbfSpE7P58RQCBsAbqqDbt8yF2gAu5qdlMf7Wr6zh3clek+QObWiKPfda5969at2afXReP17q5097fKqck+d9D0GnRQkTto+brYTqcG+hp0ukC35+U76FY+tRToNjsGBBAYfAIE+MFXZuQYAS+gJvTeeqTThXzutj2kEECgjAW6VhfKGIJVR2CwCejcvC6m62nQbwwIIFDeAtTgy7v8WXsEEEAAgSEqwEV2Q7RgWS0EEEAAgfIWIMCXd/mz9ggggAACQ1SAAD9EC5bVQgABBBAobwECfHmXP2uPAAIIIDBEBQjwQ7RgWS0EEEAAgfIWIMCXd/mz9ggggAACQ1Tg/wNkQNtLL+1NlwAAAABJRU5ErkJggg==" alt="plot of chunk sortAccuracy"/> </p>

<p>As the plot above shows, when the size of subset is less than 30, the increase of accuracies as the size of subset increase is significant. However, it starts to slow down after it becomes larger than 30. The blue line in the plot indicates where the accuracy is the highest, which is 0.7537 when the size of subset is 41 and the method is rf (random forest). The maximum accuracy point is indicated on the plot with blue vertical line.</p>

<p>Therefore, I found the line to serve as the threshold of the amount of features to keep. So I make the new training set as the following.</p>

<pre><code class="r">keeps &lt;- c(1:accuracies$subset_size[which.max(accuracies$accuracy)])
training_subset &lt;- data.frame(cbind(training_subset[,keeps],classe = training_subset$classe))
ncol(training_subset)
</code></pre>

<pre><code>## [1] 42
</code></pre>

<h2>Model construction</h2>

<p>Now let&#39;s try out using the pruned training set and tune the Random Forest model as our final model:</p>

<pre><code class="r">library(caret)
modelFit_final &lt;- train(classe ~ ., data=training_subset, method=&quot;rf&quot;)
modelFit_final
</code></pre>

<pre><code>## Random Forest 
## 
## 400 samples
##  41 predictor
##   5 classes: &#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39; 
## 
## No pre-processing
## Resampling: Bootstrapped (25 reps) 
## 
## Summary of sample sizes: 400, 400, 400, 400, 400, 400, ... 
## 
## Resampling results across tuning parameters:
## 
##   mtry  Accuracy  Kappa  Accuracy SD  Kappa SD
##    2    0.7       0.7    0.03         0.04    
##   21    0.8       0.7    0.03         0.04    
##   41    0.7       0.7    0.04         0.05    
## 
## Accuracy was used to select the optimal model using  the largest value.
## The final value used for the model was mtry = 21.
</code></pre>

<h3>Cross Validation</h3>

<p>And I do cross validation to see the justified performance of this constructed model. This returns a list of all the predicted value.</p>

<pre><code class="r">rfcv &lt;- rfcv(trainx=training_subset[,-1], trainy=training_subset[,1], cv.fold=5, scale=&quot;log&quot;, step=0.5)
</code></pre>

<h2>Model evaluation</h2>

<p>In the following, I use the testing dataset to evaluate the constructed model. Then I&#39;m ready to do the prediction :D</p>

<pre><code class="r">predict(modelFit_final, testing_subset)
</code></pre>

<pre><code>##  [1] B A B A A C D C A A B C B A E B A A B B
## Levels: A B C D E
</code></pre>

</body>

</html>

